{
  "hash": "28b9c790f1c56bdce997917f5795fff9",
  "result": {
    "engine": "knitr",
    "markdown": "# Mapas en Rstudio\n\nEs importante usar RStudio en la visualización de mapas por varias razones clave:\n\n1. **Integración de Paquetes Especializados**: RStudio ofrece acceso a una amplia variedad de paquetes especializados para visualización geoespacial, como `ggplot2`, `sf`, `rnaturalearth`, entre otros. Estos paquetes están diseñados específicamente para trabajar con datos espaciales y geográficos, lo que facilita la creación de mapas precisos y detallados.\n\n2. **Flexibilidad en la Visualización**: RStudio permite una gran flexibilidad en la personalización de mapas. Puedes ajustar colores, estilos, tamaños y añadir elementos decorativos como leyendas, escalas y anotaciones, todo ello con un alto grado de control sobre el diseño final del mapa.\n\n3. **Capacidad de Automatización y Reproducibilidad**: Utilizando scripts en RStudio, puedes automatizar la generación de mapas, lo que facilita la reproducción de los resultados y la actualización rápida cuando los datos cambian. Esto es especialmente útil en entornos donde los mapas deben ser generados regularmente o en respuesta a cambios en los datos subyacentes.\n\n4. **Análisis Integrado**: RStudio no solo se limita a la visualización estática de mapas. También puedes integrar análisis estadísticos complejos directamente con la visualización geoespacial. Por ejemplo, puedes visualizar patrones espaciales, realizar análisis de clusterización espacial o correlacionar datos geográficos con otros tipos de datos.\n\n5. **Comunidad y Recursos**: R y RStudio tienen una comunidad activa y una vasta cantidad de recursos educativos y de soporte disponibles. Esto facilita el aprendizaje y la resolución de problemas cuando se trabaja con visualización geoespacial en RStudio.\n\nEn resumen, RStudio es una herramienta poderosa y versátil para la visualización de mapas debido a su capacidad para manejar datos geoespaciales de manera eficiente, su flexibilidad en la personalización y su integración con análisis estadísticos avanzados, todo ello dentro de un entorno que fomenta la reproducibilidad y el desarrollo colaborativo.\n\n\n## Paso 1: Cargar los Paquetes Necesarios\n\nPrimero, debes cargar los paquetes que utilizarás para manipular y visualizar los datos geoespaciales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cargar paquetes necesarios\nlibrary(tidyverse)        # Para manipulación de datos y gráficos\nlibrary(readxl)           # Para leer archivos Excel\nlibrary(ggplot2)          # Para crear gráficos\nlibrary(rnaturalearth)    # Para obtener datos geoespaciales\nlibrary(rnaturalearthhires)# Para obtener datos geoespaciales de alta resolución\nlibrary(ggthemes)         # Para temas adicionales de ggplot\nlibrary(ggspatial)        # Para anotaciones espaciales como la rosa de los vientos\nlibrary(gsheet)           # Para leer datos de Google Sheets\nlibrary(scatterpie)       # Para gráficos de pastel sobre mapas\nlibrary(ggrepel)          # Para etiquetas de texto con ajuste automático\nlibrary(leaflet)          # Para mapas interactivos\nlibrary(DT)               # Para mostrar datos en tablas interactivas\n```\n:::\n\n\n## Paso 2: Preparar los Datos para el Mapa del País\n\nVamos a utilizar el paquete `rnaturalearth` para obtener los datos geoespaciales de Brasil y luego visualizarlos con `ggplot2`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtener datos geoespaciales de Brasil\nBRA <- ne_countries(country = \"Brazil\", returnclass = \"sf\")\n\n# Graficar el mapa de Brasil\nggplot(BRA) +\n  geom_sf(fill = \"white\") +\n  theme_void()  # Tema minimalista\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Paso 3: Plotear el Mapa del País con Estados\n\nPara visualizar los estados dentro de Brasil, usamos la función `ne_states`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtener datos de los estados de Brasil\nBRA <- ne_states(country = \"Brazil\", returnclass = \"sf\")\n\n# Graficar los estados de Brasil\nggplot(BRA) +\n  geom_sf(color = \"white\", fill = \"#0f52ba\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Paso 4: Seleccionar y Graficar un Estado Específico\n\nSeleccionamos un estado específico, en este caso Minas Gerais, y lo resaltamos en el mapa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filtrar para obtener solo el estado de Minas Gerais\nMG <- BRA %>%\n  filter(name_en == \"Minas Gerais\")\n\n# Graficar el mapa de Brasil con Minas Gerais resaltado\nggplot(BRA) +\n  geom_sf(color = \"black\", fill = \"white\") +\n  geom_sf(data = MG, color = \"black\", fill = \"#cf352e\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Paso 5: Plotear Puntos Específicos (Latitud y Longitud)\n\nSi tienes datos de puntos específicos, como ubicaciones con coordenadas de latitud y longitud, puedes añadirlos al mapa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Datos de ejemplo de puntos específicos\nsbr <- RustSoybean\n\n# Mostrar datos en una tabla interactiva\nsbr %>%\n  DT::datatable(\n    extensions = 'Buttons',\n    options = list(dom = 'Bfrtip', buttons = c('excel', \"csv\"))\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-972759af61be0bf5334b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-972759af61be0bf5334b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Buttons\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\"],[23,24,31,3,15,34,7,13,33,1,2,8,26,16,9,10,22,11,29,27,30,21,28,4,17,18,5,14,19,32,6,20,12,25],[-23.0418,-24.0438,-15.5454,-13.3426,-13.3426,-25.3889,-29.2294,-12.0807,-12.0807,-23.3197,-23.3197,-23.3197,-21.6304,-17.4468,-25.4197,-25.4197,-25.4197,-28.2623,-26.2292,-22.741,-25.0996,-22.5373,-7.3649,-17.7896,-17.7896,-17.7896,-16.4655,-16.4655,-16.4655,-16.4655,-13.4474,-13.4474,-19.746,-19.746],[-50.0737,-52.3811,-55.1655,-44.6357,-44.6357,-51.4613,-53.6827,-45.7787,-45.7787,-51.1662,-51.1662,-51.1662,-55.1596,-51.1762,-50.0004,-50.0004,-50.0004,-52.4103,-52.6696,-47.1743,-50.1584,-55.7282,-46.6233,-50.9205,-50.9205,-50.9205,-54.6387,-54.6387,-54.6387,-54.6387,-56.7212,-56.7212,-47.934,-47.934],[\"Cambara\",\"Campo Mourao\",\"Campo Verde\",\"Correntina\",\"Correntina\",\"Guarapuava\",\"Julio Castilhos\",\"Luis Eduardo Magalhães\",\"Luis Eduardo Magalhães\",\"Londrina\",\"Londrina\",\"Londrina\",\"Maracaju\",\"Montividiu\",\"Palmeira/Ponta Grossa\",\"Palmeira/Ponta Grossa\",\"Palmeira/Ponta Grossa\",\"Passo Fundo\",\"Pato Branco\",\"Paulinia\",\"Ponta Grossa\",\"Ponta Pora\",\"Riachao\",\"Rio Verde\",\"Rio Verde\",\"Rio Verde\",\"Rondonopolis\",\"Rondonopolis\",\"Rondonopolis\",\"Rondonopolis\",\"Sao J. Rio Claro\",\"Sao J. Rio Claro\",\"Uberaba\",\"Uberaba\"],[\"2003-11-25\",\"2003-11-28\",\"2004-11-20\",\"2002-11-10\",\"2003-11-28\",\"2004-11-29\",\"2002-12-15\",\"2003-11-12\",\"2004-11-19\",\"2002-11-06\",\"2002-12-14\",\"2003-12-17\",\"2004-11-22\",\"2004-01-20\",\"2003-11-25\",\"2003-11-05\",\"2003-12-05\",\"2003-11-28\",\"2004-12-11\",\"2004-12-02\",\"2004-11-15\",\"2003-11-28\",\"2004-12-06\",\"2002-11-29\",\"2003-11-20\",\"2003-11-25\",\"2002-11-20\",\"2003-11-20\",\"2003-11-20\",\"2004-11-20\",\"2002-11-10\",\"2003-11-25\",\"2003-12-03\",\"2004-12-15\"],[\"2004-02-02\",\"2004-02-02\",\"2005-01-25\",\"2003-01-03\",\"2004-01-31\",\"2005-03-14\",\"2003-04-10\",\"2004-02-15\",\"2005-01-25\",\"2003-02-03\",\"2003-02-10\",\"2004-02-25\",\"2005-02-28\",\"2004-04-06\",\"2004-01-10\",\"2003-12-25\",\"2004-02-04\",\"2004-03-01\",\"2005-03-07\",\"2005-01-10\",\"2005-02-26\",\"2004-02-01\",\"2005-03-01\",\"2003-01-31\",\"2004-02-04\",\"2004-03-20\",\"2003-01-03\",\"2004-01-20\",\"2004-01-09\",\"2005-01-18\",\"2003-01-03\",\"2004-02-02\",\"2004-01-18\",\"2005-03-07\"],[24,21,78,85,25,32,40,39.2,55,45,42,55,5,58,11.25,34,11,2,41.8,70,13,20,10,73,90,88,98,77.5,88,70,98,83,65,51]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>epidemia<\\/th>\\n      <th>latitude<\\/th>\\n      <th>longitude<\\/th>\\n      <th>local<\\/th>\\n      <th>planting<\\/th>\\n      <th>detection<\\/th>\\n      <th>severity<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"Bfrtip\",\"buttons\":[\"excel\",\"csv\"],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,7]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"epidemia\",\"targets\":1},{\"name\":\"latitude\",\"targets\":2},{\"name\":\"longitude\",\"targets\":3},{\"name\":\"local\",\"targets\":4},{\"name\":\"planting\",\"targets\":5},{\"name\":\"detection\",\"targets\":6},{\"name\":\"severity\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\n# Graficar puntos en el mapa de Brasil\nggplot(BRA) +\n  geom_sf(color = \"black\", fill = \"white\") +\n  geom_point(data = sbr, aes(longitude, latitude), alpha = 0.5, color = \"#ffbd2e\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n## Paso 6: Separar Fechas en Día, Mes y Año\n\nSeparar las fechas puede ser útil para análisis temporales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Separar la fecha en día, mes y año\nsbr2 <- sbr %>%\n  separate(planting, into = c(\"year\", \"month\", \"day\"), sep = \"-\", remove = FALSE)\n\n# Mostrar datos en una tabla interactiva\nsbr2 %>%\n  DT::datatable(\n    extensions = 'Buttons',\n    options = list(dom = 'Bfrtip', buttons = c('excel', \"csv\"))\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-c19b5a3554e762da5077\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c19b5a3554e762da5077\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Buttons\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\"],[23,24,31,3,15,34,7,13,33,1,2,8,26,16,9,10,22,11,29,27,30,21,28,4,17,18,5,14,19,32,6,20,12,25],[-23.0418,-24.0438,-15.5454,-13.3426,-13.3426,-25.3889,-29.2294,-12.0807,-12.0807,-23.3197,-23.3197,-23.3197,-21.6304,-17.4468,-25.4197,-25.4197,-25.4197,-28.2623,-26.2292,-22.741,-25.0996,-22.5373,-7.3649,-17.7896,-17.7896,-17.7896,-16.4655,-16.4655,-16.4655,-16.4655,-13.4474,-13.4474,-19.746,-19.746],[-50.0737,-52.3811,-55.1655,-44.6357,-44.6357,-51.4613,-53.6827,-45.7787,-45.7787,-51.1662,-51.1662,-51.1662,-55.1596,-51.1762,-50.0004,-50.0004,-50.0004,-52.4103,-52.6696,-47.1743,-50.1584,-55.7282,-46.6233,-50.9205,-50.9205,-50.9205,-54.6387,-54.6387,-54.6387,-54.6387,-56.7212,-56.7212,-47.934,-47.934],[\"Cambara\",\"Campo Mourao\",\"Campo Verde\",\"Correntina\",\"Correntina\",\"Guarapuava\",\"Julio Castilhos\",\"Luis Eduardo Magalhães\",\"Luis Eduardo Magalhães\",\"Londrina\",\"Londrina\",\"Londrina\",\"Maracaju\",\"Montividiu\",\"Palmeira/Ponta Grossa\",\"Palmeira/Ponta Grossa\",\"Palmeira/Ponta Grossa\",\"Passo Fundo\",\"Pato Branco\",\"Paulinia\",\"Ponta Grossa\",\"Ponta Pora\",\"Riachao\",\"Rio Verde\",\"Rio Verde\",\"Rio Verde\",\"Rondonopolis\",\"Rondonopolis\",\"Rondonopolis\",\"Rondonopolis\",\"Sao J. Rio Claro\",\"Sao J. Rio Claro\",\"Uberaba\",\"Uberaba\"],[\"2003-11-25\",\"2003-11-28\",\"2004-11-20\",\"2002-11-10\",\"2003-11-28\",\"2004-11-29\",\"2002-12-15\",\"2003-11-12\",\"2004-11-19\",\"2002-11-06\",\"2002-12-14\",\"2003-12-17\",\"2004-11-22\",\"2004-01-20\",\"2003-11-25\",\"2003-11-05\",\"2003-12-05\",\"2003-11-28\",\"2004-12-11\",\"2004-12-02\",\"2004-11-15\",\"2003-11-28\",\"2004-12-06\",\"2002-11-29\",\"2003-11-20\",\"2003-11-25\",\"2002-11-20\",\"2003-11-20\",\"2003-11-20\",\"2004-11-20\",\"2002-11-10\",\"2003-11-25\",\"2003-12-03\",\"2004-12-15\"],[\"2003\",\"2003\",\"2004\",\"2002\",\"2003\",\"2004\",\"2002\",\"2003\",\"2004\",\"2002\",\"2002\",\"2003\",\"2004\",\"2004\",\"2003\",\"2003\",\"2003\",\"2003\",\"2004\",\"2004\",\"2004\",\"2003\",\"2004\",\"2002\",\"2003\",\"2003\",\"2002\",\"2003\",\"2003\",\"2004\",\"2002\",\"2003\",\"2003\",\"2004\"],[\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"12\",\"11\",\"11\",\"11\",\"12\",\"12\",\"11\",\"01\",\"11\",\"11\",\"12\",\"11\",\"12\",\"12\",\"11\",\"11\",\"12\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"12\",\"12\"],[\"25\",\"28\",\"20\",\"10\",\"28\",\"29\",\"15\",\"12\",\"19\",\"06\",\"14\",\"17\",\"22\",\"20\",\"25\",\"05\",\"05\",\"28\",\"11\",\"02\",\"15\",\"28\",\"06\",\"29\",\"20\",\"25\",\"20\",\"20\",\"20\",\"20\",\"10\",\"25\",\"03\",\"15\"],[\"2004-02-02\",\"2004-02-02\",\"2005-01-25\",\"2003-01-03\",\"2004-01-31\",\"2005-03-14\",\"2003-04-10\",\"2004-02-15\",\"2005-01-25\",\"2003-02-03\",\"2003-02-10\",\"2004-02-25\",\"2005-02-28\",\"2004-04-06\",\"2004-01-10\",\"2003-12-25\",\"2004-02-04\",\"2004-03-01\",\"2005-03-07\",\"2005-01-10\",\"2005-02-26\",\"2004-02-01\",\"2005-03-01\",\"2003-01-31\",\"2004-02-04\",\"2004-03-20\",\"2003-01-03\",\"2004-01-20\",\"2004-01-09\",\"2005-01-18\",\"2003-01-03\",\"2004-02-02\",\"2004-01-18\",\"2005-03-07\"],[24,21,78,85,25,32,40,39.2,55,45,42,55,5,58,11.25,34,11,2,41.8,70,13,20,10,73,90,88,98,77.5,88,70,98,83,65,51]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>epidemia<\\/th>\\n      <th>latitude<\\/th>\\n      <th>longitude<\\/th>\\n      <th>local<\\/th>\\n      <th>planting<\\/th>\\n      <th>year<\\/th>\\n      <th>month<\\/th>\\n      <th>day<\\/th>\\n      <th>detection<\\/th>\\n      <th>severity<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"Bfrtip\",\"buttons\":[\"excel\",\"csv\"],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,10]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"epidemia\",\"targets\":1},{\"name\":\"latitude\",\"targets\":2},{\"name\":\"longitude\",\"targets\":3},{\"name\":\"local\",\"targets\":4},{\"name\":\"planting\",\"targets\":5},{\"name\":\"year\",\"targets\":6},{\"name\":\"month\",\"targets\":7},{\"name\":\"day\",\"targets\":8},{\"name\":\"detection\",\"targets\":9},{\"name\":\"severity\",\"targets\":10}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Paso 7: Graficar Puntos con Colores por Año y Facetas\n\nPodemos colorear los puntos según el año y crear facetas para cada año.\n\n\n::: {.cell fig.fullwidth='true'}\n\n```{.r .cell-code}\n# Graficar puntos coloreados por año y con facetas por año\nggplot(BRA) +\n  geom_sf(color = \"black\", fill = \"white\") +\n  geom_point(data = sbr2, aes(longitude, latitude, color = year), alpha = 0.5) +\n  facet_wrap(~year) +\n  theme_few() +\n  scale_color_few() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-7-1.png){width=1440}\n:::\n:::\n\n\n## Paso 8: Añadir Rosa de los Vientos y Escala\n\nPara añadir una rosa de los vientos y una escala al mapa, usamos el paquete `ggspatial`.\n\n\n::: {.cell fig.fullwidth='true'}\n\n```{.r .cell-code}\n# Añadir rosa de los vientos y escala\nggplot(BRA) +\n  annotation_north_arrow(location = \"bl\") +\n  annotation_scale(location = \"br\") +\n  geom_sf(color = \"black\", fill = \"white\") +\n  geom_point(data = sbr2, aes(longitude, latitude, color = year, size = severity), alpha = 0.6) +\n  facet_wrap(~year) +\n  theme_few() +\n  scale_colour_manual(values = c(\"#6aa84f\", \"#ffbd2e\", \"#cf352e\")) +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-8-1.png){width=1440}\n:::\n:::\n\n\n## Paso 9: adicionar un scatterpie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1pAIFKsdKxk_UQQXdYwIO-O5NOkYNhpclImJcLziYnk4/edit?gid=50258992#gid=50258992\")\n\nmapa  |> \n      DT::datatable(\n      extensions = 'Buttons', \n      options = list(dom = 'Bfrtip', \n      buttons = c('excel', \"csv\")))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-972759af61be0bf5334b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-972759af61be0bf5334b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Buttons\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\"],[\"São João\",\"Ponta Grossa\",\"Londrina\",\"Campo Mourão\",\"Cafelândia\",\"Santa Cruz do Sul\",\"Passo Fundo\",\"Lavras\",\"Rio Verde\",\"Silvânia\",\"Bandeirantes\",\"Maracajú\",\"Campo Verde\",\"Deciolândia\",\"Lucas Rio Verde\",\"Querência\",\"Primavera do Leste\",\"Sapezal\",\"Patrocíno Paulista\",\"Roda Velha\",\"Porto Nacional\"],[-25.8278,-25.0994,-23.3197,-24.0438,-24.6172,-29.7241,-28.2623,-21.2399,-17.7928,-16.6655,-19.918,-21.6304,-15.5454,-14.1838,-13.0764,-12.5943,-15.5571,-13.548,-20.6412,-12.7825,-10.7069],[-52.7237,-50.1583,-51.1662,-52.381,-53.3231,-52.4358,-52.4103,-44.9984,-50.9196,-48.6119,-54.3684,-55.1596,-55.1655,-57.5066,-55.9094,-52.2078,-54.2975,-58.8161,-47.2812,-45.9519,-48.4126],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,1,0,0,0,0,0,1,0,1,1,1,1,1,1,1,0,0,0],[1,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Local<\\/th>\\n      <th>lat<\\/th>\\n      <th>lon<\\/th>\\n      <th>DFC<\\/th>\\n      <th>MA<\\/th>\\n      <th>FER<\\/th>\\n      <th>ANTR<\\/th>\\n      <th>OIDIO<\\/th>\\n      <th>ensaios<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"Bfrtip\",\"buttons\":[\"excel\",\"csv\"],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Local\",\"targets\":1},{\"name\":\"lat\",\"targets\":2},{\"name\":\"lon\",\"targets\":3},{\"name\":\"DFC\",\"targets\":4},{\"name\":\"MA\",\"targets\":5},{\"name\":\"FER\",\"targets\":6},{\"name\":\"ANTR\",\"targets\":7},{\"name\":\"OIDIO\",\"targets\":8},{\"name\":\"ensaios\",\"targets\":9}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell fig.fullwidth='true'}\n\n```{.r .cell-code}\nlibrary(scatterpie)\nlibrary(ggrepel)\n\n\nggplot(BRA) +\n  geom_sf(fill = \"white\", color = \"black\", linewidth = 0.5) +\n  coord_sf()+\n  geom_point(data = mapa, aes(lon, lat))+\n  geom_scatterpie(aes(x=lon, y=lat, r = 0.6),\n                  alpha = 0.8, color = NA, data = mapa,\n                  cols = c (\"DFC\",\n                            \"MA\",\n                            \"FER\",\n                            \"ANTR\",\n                            \"OIDIO\"))+\n  geom_text_repel(data = mapa, aes(lon, lat, label = Local),\n                  size = 2, nudge_x = 0.2, nudge_y = 0.27, color = 'gray30', family = \"Arial\")+\n  theme_few()+\n  scale_fill_few()+\n  labs(x = \"Longitude\", y = \"Laititude\", legend = \"\", fill = \"Doença\")+\n  theme(legend.position = \"bottom\", text = element_text(family = \"Arieal\", size = 8))\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Ejemplo de Mapa en Colombia\n\nVamos a mostrar un ejemplo de cómo aplicar estos conceptos a otro país, en este caso, Colombia.\n\n### Conjunto de Datos y Plot del Mapa del País\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtener datos de Colombia\nCOL <- ne_states(country = \"Colombia\", returnclass = \"sf\")\n\n# Graficar el mapa de Colombia\nggplot(COL) +\n  geom_sf(color = \"black\", fill = \"#eeeeee\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Seleccionar el Departamento de Caldas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filtrar para obtener solo el departamento de Caldas\nCAL <- COL[COL$name_en == \"Caldas\", ]\n\n# Graficar el mapa de Caldas\nggplot(CAL) +\n  geom_sf(color = \"black\", fill = \"#7d0c0c\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Base de Datos de Almacenes de Café en Caldas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Datos de almacenes de café en Caldas\nAlmacenes <- tibble::tribble(\n  ~City, ~Almacen, ~Latitude, ~Longitude, ~Origen, ~Distancia,\n  \"Aguadas\", \"Aguadas\", 5.614441346, -75.45745866, \"Manizales\", 94L,\n  \"Anserma\", \"Anserma\", 5.230185862, -75.78747373, \"Manizales\", 68L,\n  \"Aranzazu\", \"Aranzazu\", 5.273885516, -75.4906769, \"Manizales\", 52L,\n  \"Arauca\", \"Arauca\", 5.111797165, -75.70237449, \"Manizales\", 40L,\n  \"Belalcázar\", \"Belalcázar\", 4.993657529, -75.8124391, \"Manizales\", 73L,\n  \"Chinchiná\", \"Chinchiná\", 4.982784299, -75.60599158, \"Manizales\", 25L,\n  \"Chinchiná\", \"Express Chinchiná\", 4.984223599, -75.60351371, \"Manizales\", 25L,\n  \"Filadelfia\", \"Filadelfia\", 5.296549523, -75.56330843, \"Manizales\", 50L,\n  \"Florencia\", \"Florencia\", 5.523442194, -75.0419965, \"Manizales\", 76L,\n  \"La Merced\", \"La Merced\", 5.398797857, -75.54735513, \"Manizales\", 87L,\n  \"Manizales\", \"Manizales\", 5.068354629, -75.52250821, \"Manizales\", NA,\n  \"Manizales\", \"Centro\", 5.066015662, -75.52027854, \"Manizales\", NA,\n  \"Manzanares\", \"Manzanares\", 5.253637095, -75.1546019, \"Manizales\", 106L,\n  \"Marmato\", \"Marmato\", 5.474778144, -75.5991209, \"Manizales\", 92L,\n  \"Marquetalia\", \"Marquetalia\", 5.297556319, -75.05356293, \"Manizales\", 133L,\n  \"Montebonito\", \"Montebonito\", 5.164502404, -75.20083577, \"Manizales\", 74L,\n  \"Neira\", \"Neira\", 5.168677095, -75.52064365, \"Manizales\", 21L,\n  \"Pácora\", \"Pácora\", 5.527640673, -75.45833093, \"Manizales\", 108L,\n  \"Palestina\", \"Palestina\", 5.020646532, -75.62224573, \"Manizales\", 31L,\n  \"Pensilvania\", \"Pensilvania\", 5.382094679, -75.16095633, \"Manizales\", 138L,\n  \"Riosucio\", \"Riosucio\", 5.420500318, -75.70330599, \"Manizales\", 94L,\n  \"Risaralda\", \"Risaralda\", 5.164827869, -75.76656659, \"Manizales\", 54L,\n  \"Salamina\", \"Salamina\", 5.406270495, -75.48804138, \"Manizales\", 75L,\n  \"Samaná\", \"Samaná\", 5.413305395, -74.9918933, \"Manizales\", 172L,\n  \"Samaria\", \"Samaria\", 5.231695042, -75.57004909, \"Manizales\", 44L,\n  \"San Bartolomé\", \"San Bartolomé\", 5.488163145, -75.54230827, \"Manizales\", 100L,\n  \"San José\", \"San José\", 5.080518037, -75.79193293, \"Manizales\", 68L,\n  \"Supía\", \"Supía\", 5.45575962, -75.64910349, \"Manizales\", 82L,\n  \"Victoria\", \"Victoria\", 5.316772447, -74.91163876, \"Manizales\", 136L,\n  \"Viterbo\", \"Viterbo\", 5.060618313, -75.8733643, \"Manizales\", 72L\n)\n\n# Mostrar datos en una tabla\nAlmacenes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 30 × 6\n   City       Almacen           Latitude Longitude Origen    Distancia\n   <chr>      <chr>                <dbl>     <dbl> <chr>         <int>\n 1 Aguadas    Aguadas               5.61     -75.5 Manizales        94\n 2 Anserma    Anserma               5.23     -75.8 Manizales        68\n 3 Aranzazu   Aranzazu              5.27     -75.5 Manizales        52\n 4 Arauca     Arauca                5.11     -75.7 Manizales        40\n 5 Belalcázar Belalcázar            4.99     -75.8 Manizales        73\n 6 Chinchiná  Chinchiná             4.98     -75.6 Manizales        25\n 7 Chinchiná  Express Chinchiná     4.98     -75.6 Manizales        25\n 8 Filadelfia Filadelfia            5.30     -75.6 Manizales        50\n 9 Florencia  Florencia             5.52     -75.0 Manizales        76\n10 La Merced  La Merced             5.40     -75.5 Manizales        87\n# ℹ 20 more rows\n```\n\n\n:::\n:::\n\n\n### Graficar Almacenes en el Mapa de Caldas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Graficar puntos de almacenes en el mapa de Caldas\nggplot(CAL) +\n  geom_sf(color = \"black\", fill = \"white\") +\n  geom_point(data = Almacenes, aes(x = Longitude, y = Latitude), color = \"#7d0c0c\") +\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula16_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### Crear un Mapa Interactivo con Leaflet\n\n\n::: {.cell fig.fullwidth='true'}\n\n```{.r .cell-code}\n# Crear un mapa interactivo con Leaflet\nleaflet(Almacenes) |> \n  addTiles() |> \n  setView(-72.0000000, 4.0000000, zoom = 6) |> \n  addCircleMarkers(~Longitude, ~Latitude, popup = ~Almacen, weight = 3, radius = 2, color = \"#7d0c0c\", stroke = TRUE, fillOpacity = 0.8)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-61be0bf5334bc19b5a35\" style=\"width:100%;height:650px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-61be0bf5334bc19b5a35\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org/copyright/\\\">OpenStreetMap<\\/a>,  <a href=\\\"https://opendatacommons.org/licenses/odbl/\\\">ODbL<\\/a>\"}]},{\"method\":\"addCircleMarkers\",\"args\":[[5.614441346,5.230185862,5.273885516,5.111797165,4.993657529,4.982784299,4.984223599,5.296549523,5.523442194,5.398797857,5.068354629,5.066015662,5.253637095,5.474778144,5.297556319,5.164502404,5.168677095,5.527640673,5.020646532,5.382094679,5.420500318,5.164827869,5.406270495,5.413305395,5.231695042,5.488163145,5.080518037,5.45575962,5.316772447,5.060618313],[-75.45745866,-75.78747373,-75.4906769,-75.70237449,-75.81243910000001,-75.60599157999999,-75.60351371,-75.56330843000001,-75.0419965,-75.54735513,-75.52250821,-75.52027854000001,-75.1546019,-75.5991209,-75.05356293,-75.20083577,-75.52064365,-75.45833093,-75.62224573,-75.16095633,-75.70330599,-75.76656659,-75.48804138,-74.9918933,-75.57004909,-75.54230827000001,-75.79193293,-75.64910349,-74.91163876,-75.87336430000001],2,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"#7d0c0c\",\"weight\":3,\"opacity\":0.5,\"fill\":true,\"fillColor\":\"#7d0c0c\",\"fillOpacity\":0.8},null,null,[\"Aguadas\",\"Anserma\",\"Aranzazu\",\"Arauca\",\"Belalcázar\",\"Chinchiná\",\"Express Chinchiná\",\"Filadelfia\",\"Florencia\",\"La Merced\",\"Manizales\",\"Centro\",\"Manzanares\",\"Marmato\",\"Marquetalia\",\"Montebonito\",\"Neira\",\"Pácora\",\"Palestina\",\"Pensilvania\",\"Riosucio\",\"Risaralda\",\"Salamina\",\"Samaná\",\"Samaria\",\"San Bartolomé\",\"San José\",\"Supía\",\"Victoria\",\"Viterbo\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"setView\":[[4,-72],6,[]],\"limits\":{\"lat\":[4.982784299,5.614441346],\"lng\":[-75.87336430000001,-74.91163876]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Aprendizaje del día\n\nCon esta guía, has aprendido cómo cargar datos geoespaciales, visualizarlos en mapas, y personalizar esos mapas en RStudio utilizando varios paquetes. Puedes aplicar estos conceptos a diferentes regiones y tipos de datos según tus necesidades.\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<script src=\"site_libs/jszip-1.13.6/jszip.min.js\"></script>\n<link href=\"site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-binding-2.2.2/leaflet.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}